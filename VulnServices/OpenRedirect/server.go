package main

import (
	"fmt"
	"log"
	"net/http"
)
func openRedirect(w http.ResponseWriter, r *http.Request){
	redirectUrl := r.URL.Query().Get("redirect_to")
	log.Println(redirectUrl)
	http.Redirect(w, r,  redirectUrl, http.StatusFound)
}

func renderIndex(w http.ResponseWriter, r *http.Request){
	fmt.Fprint(w, "<a href=http://localhost:8000/redirect?redirect_to=https://google.com>Ask Google a question</a>")
}

func main() {
	fmt.Println("Starting Web Server with Open Redirect vulnerability")
	http.HandleFunc("/redirect", openRedirect)
	http.HandleFunc("/", renderIndex)
	if err := http.ListenAndServe(":8000", nil); err != nil {
		log.Fatal(err)
	}
}
